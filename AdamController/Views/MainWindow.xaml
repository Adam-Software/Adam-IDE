<mah:MetroWindow  x:Class="AdamController.Views.MainWindow"
                  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                  xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
                  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                  xmlns:viewModels="clr-namespace:AdamController.ViewModels"
                  xmlns:viewModelsHamburgerMenu="clr-namespace:AdamController.ViewModels.HamburgerMenu"
                  xmlns:views="clr-namespace:AdamController.Views"
                  xmlns:viewsHamburgerItem="clr-namespace:AdamController.Views.HamburgerPage"
                  xmlns:mah="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro" 
                  xmlns:uiConverter="clr-namespace:AdamController.Converters"
                  xmlns:properties="clr-namespace:AdamController.Properties"
                  TitleCharacterCasing="Normal"
                  mc:Ignorable="d"
                  WindowState="Maximized"
                  ShowIconOnTitleBar="True"
                  
                  Title="{Binding WindowTitle}">

    <!--#region Window resources -->

    <mah:MetroWindow.Resources>
        <ResourceDictionary>
            <uiConverter:MultiConverter x:Key="MultiConverter"/>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/VS/Controls.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </mah:MetroWindow.Resources>

    <!--#endregion-->
    
    <!--#region TitleTemplate -->
    
    <mah:MetroWindow.TitleTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal" 
                        VerticalAlignment="Center"  
                        HorizontalAlignment="Right">

                <iconPacks:PackIconUnicons Kind="Robot" 
                                       Height="15"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"/>


                <TextBlock Text="{Binding}"
                    FontWeight="Medium"
                           FontSize="15"
                           Margin="10 2 10 0"
                           HorizontalAlignment="Center"
                           TextAlignment="Right"
                           Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"/>
            </StackPanel>
        </DataTemplate>
    </mah:MetroWindow.TitleTemplate>
    
    <!--#endregion-->

    <!--#region LeftWindowCommands -->
    
    <mah:MetroWindow.LeftWindowCommands>
        <mah:WindowCommands>
            <StackPanel Orientation="Horizontal">
                <views:MainMenu/>
            </StackPanel>
        </mah:WindowCommands>
    </mah:MetroWindow.LeftWindowCommands>
    
    <!--#endregion-->

    <mah:MetroWindow.Flyouts>
        <mah:FlyoutsControl>

            <!--#region Flayouts Advanced blockly settings -->

            <mah:Flyout IsOpen="{Binding AdvancedBlocklySettingsFlayoutsIsOpen}"
                        AnimateOpacity="True"
                        Position="Right"
                        Theme="Adapt"
                        AreAnimationsEnabled="True"
                        AnimateOnPositionChange="True"
                        ExternalCloseButton="Left"
                        CloseButtonVisibility="Visible"
                        IsModal="True"
                        Header="Продвинутые настройки скретч-редактора"
                        ContentTemplate="{Binding ElementName=FlayoutBlocklySettingsTemplate}">

                <ScrollViewer HorizontalScrollBarVisibility="Visible"
                              Style="{DynamicResource MahApps.Styles.ScrollViewer}">

                    <Grid x:Name="FlayoutBlocklySettingsTemplate" Width="Auto" Margin="20 0 0 0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"></ColumnDefinition>
                            <ColumnDefinition Width="210"></ColumnDefinition>
                            <ColumnDefinition Width="Auto"></ColumnDefinition>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0"
                               Grid.ColumnSpan="4"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Left"
                               FontWeight="Bold"
                               Margin="0 20 0 10"
                               Text="Настройки панели инструментов"/>

                        <!--#region logic category-->

                        <mah:ToggleSwitch Grid.Row="2" Grid.Column="0"
                                          IsEnabled="False"
                                          Margin="7 0 0 0"
                                          x:Name="LogicSwitch"
                                          Header="Цвет категории логические"
                                          OnContent="Вручную"
                                          OffContent="Автоматически"
                                          IsOn="{Binding BlocklyLogicCategoryStateD, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"
                                          VerticalAlignment="Bottom"/>

                        <mah:ColorPalette Grid.Row="2" Grid.Column="1"
                                          IsEnabled="{Binding ElementName=LogicSwitch, Path=IsEnabled}"
                                          VerticalAlignment="Bottom"
                                          HorizontalAlignment="Center"
                                          SelectedItem="{Binding BlocklyGridColour}"
                                          Style="{DynamicResource MahApps.Styles.ListBox.HamburgerMenu}" >
                            <Color>Red</Color>
                            <Color>Green</Color>
                            <Color>Blue</Color>
                            <Color>Black</Color>
                            <Color>Yellow</Color>
                            <Color>White</Color>
                            <Color>Gray</Color>
                        </mah:ColorPalette>


                        <TextBox Grid.Row="2" Grid.Column="3"
                             Text="{Binding BlocklyLogicCategoryAlternateName, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"
                             FontWeight="Bold"
                             VerticalAlignment="Bottom" 
                             HorizontalAlignment="Left" 
                             TextAlignment="Left"
                             Style="{DynamicResource MahApps.Styles.TextBox.Window.QuickLaunch.VisualStudio}"
                             Margin="0 0 20 0"
                             
                             
                             mah:TextBoxHelper.ClearTextButton="True"
                             mah:TextBoxHelper.Watermark="Альтернативное название"/>

                        <!--#endregion-->

                        <!--#region color category-->

                        <mah:ToggleSwitch Grid.Row="3" Grid.Column="0"
                                          IsEnabled="False"
                                          Margin="7 0 0 0"
                                          x:Name="ColourSwitch"
                                          Header="Цвет категории цвета"
                                          OnContent="Вручную"
                                          OffContent="Автоматически"
                                          IsOn="{Binding BlocklyColorCategoryStateD, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"
                                          VerticalAlignment="Bottom"/>

                        <mah:ColorPalette Grid.Row="3" Grid.Column="1"
                                          IsEnabled="{Binding ElementName=ColourSwitch, Path=IsEnabled}"
                                          VerticalAlignment="Bottom"
                                          HorizontalAlignment="Center"
                                          SelectedItem="{Binding BlocklyGridColour}"
                                          Style="{DynamicResource MahApps.Styles.ListBox.HamburgerMenu}" >
                            <Color>Red</Color>
                            <Color>Green</Color>
                            <Color>Blue</Color>
                            <Color>Black</Color>
                            <Color>Yellow</Color>
                            <Color>White</Color>
                            <Color>Gray</Color>
                        </mah:ColorPalette>


                        <TextBox Grid.Row="3" Grid.Column="3"
                             Text="{Binding BlocklyColourCategoryAlternateName, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"
                             FontWeight="Bold"
                             VerticalAlignment="Bottom" 
                             HorizontalAlignment="Left" 
                             TextAlignment="Left"
                             Style="{DynamicResource MahApps.Styles.TextBox.Window.QuickLaunch.VisualStudio}"
                             Margin="0 0 20 0"
                             
                             mah:TextBoxHelper.ClearTextButton="True"
                             mah:TextBoxHelper.Watermark="Альтернативное название"/>

                        <!--#endregion-->

                        <!--#region lists category-->

                        <mah:ToggleSwitch Grid.Row="4" Grid.Column="0"
                                          IsEnabled="False"
                                          Margin="7 0 0 0"
                                          x:Name="ListsSwitch"
                                          Header="Цвет категория cписки"
                                          OnContent="Вручную"
                                          OffContent="Автоматически"
                                          VerticalAlignment="Bottom"
                                          IsOn="{Binding BlocklyListsCategoryStateD, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"/>

                        <mah:ColorPalette Grid.Row="4" Grid.Column="1"
                                          IsEnabled="{Binding ElementName=ListsSwitch, Path=IsEnabled}"
                                          VerticalAlignment="Bottom"
                                          HorizontalAlignment="Center"
                                          SelectedItem="{Binding BlocklyGridColour}"
                                          Style="{DynamicResource MahApps.Styles.ListBox.HamburgerMenu}" >
                            <Color>Red</Color>
                            <Color>Green</Color>
                            <Color>Blue</Color>
                            <Color>Black</Color>
                            <Color>Yellow</Color>
                            <Color>White</Color>
                            <Color>Gray</Color>
                        </mah:ColorPalette>


                        <TextBox Grid.Row="4" Grid.Column="3"
                                 Text="{Binding BlocklyListsCategoryAlternateName, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"
                                 FontWeight="Bold"
                                 VerticalAlignment="Bottom" 
                                 HorizontalAlignment="Left" 
                                 TextAlignment="Left"
                                 Style="{DynamicResource MahApps.Styles.TextBox.Window.QuickLaunch.VisualStudio}"
                                 Margin="0 0 20 0"
                         
                                 mah:TextBoxHelper.ClearTextButton="True"
                                 mah:TextBoxHelper.Watermark="Альтернативное название"/>

                        <!--#endregion-->

                        <!--#region loop category-->

                        <mah:ToggleSwitch Grid.Row="5" Grid.Column="0"
                                          IsEnabled="False"
                                          Margin="7 0 0 0"
                                          x:Name="LoopSwitch"
                                          Header="Цвет категории циклы"
                                          OnContent="Вручную"
                                          OffContent="Автоматически"
                                          VerticalAlignment="Bottom"
                                          IsOn="{Binding BlocklyLoopCategoryStateD, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"/>

                        <mah:ColorPalette Grid.Row="5" Grid.Column="1"
                                          IsEnabled="{Binding ElementName=LoopSwitch, Path=IsEnabled}"
                                          VerticalAlignment="Bottom"
                                          HorizontalAlignment="Center"
                                          SelectedItem="{Binding BlocklyGridColour}"
                                          Style="{DynamicResource MahApps.Styles.ListBox.HamburgerMenu}">
                            <Color>Red</Color>
                            <Color>Green</Color>
                            <Color>Blue</Color>
                            <Color>Black</Color>
                            <Color>Yellow</Color>
                            <Color>White</Color>
                            <Color>Gray</Color>
                        </mah:ColorPalette>


                        <TextBox Grid.Row="5" Grid.Column="3"
                                 Text="{Binding BlocklyLoopCategoryAlternateName, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"
                                 FontWeight="Bold"
                                 VerticalAlignment="Bottom" 
                                 HorizontalAlignment="Left" 
                                 TextAlignment="Left"
                                 Style="{DynamicResource MahApps.Styles.TextBox.Window.QuickLaunch.VisualStudio}"
                                 Margin="0 0 20 0"
                         
                                 mah:TextBoxHelper.ClearTextButton="True"
                                 mah:TextBoxHelper.Watermark="Альтернативное название"/>

                        <!--#endregion-->

                        <!--#region math category-->

                        <mah:ToggleSwitch Grid.Row="6" Grid.Column="0"
                                          IsEnabled="False"
                                          Margin="7 0 0 0"
                                          x:Name="MathSwitch"
                                          Header="Цвет категории математические"                                          
                                          OnContent="Вручную"
                                          OffContent="Автоматически"
                                          VerticalAlignment="Bottom"
                                          IsOn="{Binding BlocklyMathCategoryStateD, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"/>

                        <mah:ColorPalette Grid.Row="6" Grid.Column="1"
                                          IsEnabled="{Binding ElementName=MathSwitch, Path=IsEnabled}"
                                          VerticalAlignment="Bottom"
                                          HorizontalAlignment="Center"
                                          SelectedItem="{Binding BlocklyGridColour}"
                                          Style="{DynamicResource MahApps.Styles.ListBox.HamburgerMenu}">

                            <Color>Red</Color>
                            <Color>Green</Color>
                            <Color>Blue</Color>
                            <Color>Black</Color>
                            <Color>Yellow</Color>
                            <Color>White</Color>
                            <Color>Gray</Color>
                        </mah:ColorPalette>


                        <TextBox Grid.Row="6" Grid.Column="3"
                                 Text="{Binding BlocklyMathCategoryAlternateName, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"
                                 FontWeight="Bold"
                                 VerticalAlignment="Bottom" 
                                 HorizontalAlignment="Left" 
                                 TextAlignment="Left"
                                 Style="{DynamicResource MahApps.Styles.TextBox.Window.QuickLaunch.VisualStudio}"
                                 Margin="0 0 20 0"
                                 mah:TextBoxHelper.ClearTextButton="True"
                                 mah:TextBoxHelper.Watermark="Альтернативное название"/>

                        <!--#endregion-->

                        <!--#region procedure category-->

                        <mah:ToggleSwitch Grid.Row="7" Grid.Column="0"
                                          IsEnabled="False"
                                          Margin="7 0 0 0"
                                          x:Name="ProcedureSwitch"
                                          Header="Цвет категории процедуры"
                                          OnContent="Вручную"
                                          OffContent="Автоматически"
                                          VerticalAlignment="Bottom"
                                          IsOn="{Binding BlocklyProcedureCategoryStateD, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"/>

                        <mah:ColorPalette Grid.Row="7" Grid.Column="1"
                                          IsEnabled="{Binding ElementName=ProcedureSwitch, Path=IsEnabled}"
                                          VerticalAlignment="Bottom"
                                          HorizontalAlignment="Center"
                                          SelectedItem="{Binding BlocklyGridColour}"
                                          Style="{DynamicResource MahApps.Styles.ListBox.HamburgerMenu}">
                            <Color>Red</Color>
                            <Color>Green</Color>
                            <Color>Blue</Color>
                            <Color>Black</Color>
                            <Color>Yellow</Color>
                            <Color>White</Color>
                            <Color>Gray</Color>
                        </mah:ColorPalette>


                        <TextBox Grid.Row="7" Grid.Column="3"
                                 Text="{Binding BlocklyProcedureCategoryAlternateName, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"
                                 FontWeight="Bold"
                                 VerticalAlignment="Bottom" 
                                 HorizontalAlignment="Left" 
                                 TextAlignment="Left"
                                 Style="{DynamicResource MahApps.Styles.TextBox.Window.QuickLaunch.VisualStudio}"
                                 Margin="0 0 20 0"
                                 mah:TextBoxHelper.ClearTextButton="True"
                                 mah:TextBoxHelper.Watermark="Альтернативное название"/>

                        <!--#endregion-->

                        <!--#region dynamic variable category-->

                        <mah:ToggleSwitch Grid.Row="8" Grid.Column="0"
                                          IsEnabled="False"
                                          Margin="7 0 20 0"
                                          x:Name="DynamicVariableSwitch"
                                          Header="Цвет категории динамические переменные"
                                          OnContent="Вручную"
                                          OffContent="Автоматически"
                                          VerticalAlignment="Bottom"
                                          IsOn="{Binding BlocklyDynamicVariableCategoryStateD, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"
                                      />

                        <mah:ColorPalette Grid.Row="8" Grid.Column="1"
                                          IsEnabled="{Binding ElementName=DynamicVariableSwitch, Path=IsEnabled}"
                                          VerticalAlignment="Bottom"
                                          HorizontalAlignment="Center"
                                          Margin="0 0 0 3"
                                          SelectedItem="{Binding BlocklyGridColour}"
                                          Style="{DynamicResource MahApps.Styles.ListBox.HamburgerMenu}" >
                            <Color>Red</Color>
                            <Color>Green</Color>
                            <Color>Blue</Color>
                            <Color>Black</Color>
                            <Color>Yellow</Color>
                            <Color>White</Color>
                            <Color>Gray</Color>
                        </mah:ColorPalette>


                        <TextBox Grid.Row="8" Grid.Column="3"
                                 Text="{Binding BlocklyDynamicVariableCategoryAlternateName, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"
                                 FontWeight="Bold"
                                 VerticalAlignment="Bottom" 
                                 HorizontalAlignment="Left" 
                                 TextAlignment="Left"
                                 Style="{DynamicResource MahApps.Styles.TextBox.Window.QuickLaunch.VisualStudio}"
                                 Margin="0 0 20 0"
                                 
                                 mah:TextBoxHelper.ClearTextButton="True"
                                 mah:TextBoxHelper.Watermark="Альтернативное название"/>

                        <!--#endregion-->

                        <!--#region variable category-->

                        <mah:ToggleSwitch Grid.Row="9"
                                          IsEnabled="False"
                                          Margin="7 0 0 0"
                                          x:Name="VariableSwitch"
                                          Header="Цвет категории переменные"
                                          OnContent="Вручную"
                                          OffContent="Автоматически"
                                          VerticalAlignment="Bottom"
                                          IsOn="{Binding BlocklyVariableCategoryStateD, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"/>

                        <mah:ColorPalette Grid.Row="9" Grid.Column="1"
                                          IsEnabled="{Binding ElementName=VariableSwitch, Path=IsEnabled}"
                                          VerticalAlignment="Bottom"
                                          HorizontalAlignment="Center"
                                          Margin="0 0 0 3"
                                          SelectedItem="{Binding BlocklyGridColour}"
                                          Style="{DynamicResource MahApps.Styles.ListBox.HamburgerMenu}">
                            <Color>Red</Color>
                            <Color>Green</Color>
                            <Color>Blue</Color>
                            <Color>Black</Color>
                            <Color>Yellow</Color>
                            <Color>White</Color>
                            <Color>Gray</Color>
                        </mah:ColorPalette>


                        <TextBox Grid.Row="9" Grid.Column="3"
                                 Text="{Binding BlocklyVariableCategoryAlternateName, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"
                                 FontWeight="Bold"
                                 VerticalAlignment="Bottom" 
                                 HorizontalAlignment="Left" 
                                 TextAlignment="Left"
                                 Style="{DynamicResource MahApps.Styles.TextBox.Window.QuickLaunch.VisualStudio}"
                                 Margin="0 0 20 0"
                                 mah:TextBoxHelper.ClearTextButton="True"
                                 mah:TextBoxHelper.Watermark="Альтернативное название"/>

                        <!--#endregion-->

                        <!--#region language toolbox settings-->

                        <mah:ToggleSwitch Grid.Row="10" Grid.Column="0"
                                          Margin="7 0 0 0"
                                          x:Name="ChangeToolboxLanguage"
                                          Header="Язык панели инструментов"
                                          OnContent="Вручную"
                                          OffContent="Автоматически"
                                          VerticalAlignment="Bottom"
                                          Command="{Binding ChangeToolboxLanguageToggleSwitchCommand}"
                                          CommandParameter="{Binding ElementName=ChangeToolboxLanguage, Path=IsOn}"
                                          IsOn="{Binding ChangeToolboxLanguageToggleSwitchState, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"/>

                        <mah:SplitButton Grid.Row="10" Grid.Column="1"
                                         IsEnabled="{Binding ElementName=ChangeToolboxLanguage, Path=IsOn}"
                                         Margin="5 20 20 5"
                                         DisplayMemberPath="LanguageName"
                                         VerticalContentAlignment="Center"
                                         HorizontalContentAlignment="Left"
                                         
                                         FontWeight="Normal"
                                         ItemsSource="{Binding BlocklyLanguageCollection}"
                                         SelectedItem="{Binding SelectedBlocklyToolboxLanguage}">

                            <mah:SplitButton.Icon>
                                <StackPanel Orientation="Horizontal">
                                    <iconPacks:PackIconFeatherIcons Kind="Globe" Margin="5 0 5 0"/>
                                </StackPanel>
                            </mah:SplitButton.Icon>
                        </mah:SplitButton>

                        <!--#endregion-->

                        <TextBlock Grid.Row="11" Grid.Column="0"
                               Grid.ColumnSpan="3"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Left"
                               FontWeight="Bold"
                               Margin="0 20 0 10"
                               Text="Настройки рабочей области"/>

                        <!--#region grid color -->

                        <mah:ToggleSwitch Grid.Row="12" Grid.Column="0"
                                          Margin="7 0 0 0"
                                          x:Name="ChangeGridColorSwitch"
                                          Header="Цвет сетки"
                                          OnContent="Вручную"
                                          OffContent="Автоматически"
                                          VerticalAlignment="Bottom"
                                          Command="{Binding ChangeGridColorToggleSwitchCommand}"
                                          CommandParameter="{Binding ElementName=ChangeGridColorSwitch, Path=IsOn}"
                                          IsEnabled="{Binding BlocklyShowGrid, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"
                                          IsOn="{Binding ChangeGridColorSwitchToggleSwitchState, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"/>

                        <mah:ColorPalette Grid.Row="12" Grid.Column="1"
                                          Padding="0 0 0 10"
                                          VerticalAlignment="Bottom"
                                          HorizontalAlignment="Center"
                                          SelectedItem="{Binding SelectedBlocklyGridColour}"
                                          Style="{DynamicResource MahApps.Styles.ListBox.HamburgerMenu}">

                            <Color>Red</Color>
                            <Color>Green</Color>
                            <Color>Blue</Color>
                            <Color>Black</Color>
                            <Color>Yellow</Color>
                            <Color>White</Color>
                            <Color>Gray</Color>

                            <mah:ColorPalette.IsEnabled>
                                <MultiBinding Converter="{StaticResource MultiConverter}">
                                    <Binding ElementName="ChangeGridColorSwitch" Path="IsOn"/>
                                    <Binding ElementName="ChangeGridColorSwitch" Path="IsEnabled"/>
                                </MultiBinding>
                            </mah:ColorPalette.IsEnabled>
                        </mah:ColorPalette>

                        <!--#endregion-->

                        <!--#region Grid Spacing -->

                        <mah:ToggleSwitch Grid.Row="13" Grid.Column="0"
                                          Margin="7 0 0 0"
                                          x:Name="ChangeSpacingSwitch"
                                          Header="Размер ячейки"
                                          OnContent="Вручную"
                                          OffContent="Автоматически"
                                          VerticalAlignment="Bottom"
                                          IsOn="{Binding  ChangeSpacingSwitchToggleSwitchState, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"
                                          IsEnabled="{Binding BlocklyShowGrid, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"
                                          Command="{Binding ChangeSpacingToggleSwitchCommand}"
                                          CommandParameter="{Binding ElementName=ChangeSpacingSwitch, Path=IsOn}"/>

                        <mah:NumericUpDown Grid.Row="13" Grid.Column="1"
                                           Value="{Binding BlocklyGridSpacing, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"
                                           Padding="0 0 4 0"
                                           Minimum="5"
                                           Maximum="50"
                                           Interval="5"
                                           
                                           FontWeight="Medium"
                                           TextAlignment="Right"
                                           Margin="5 20 20 5">

                            <mah:NumericUpDown.IsEnabled>
                                <MultiBinding Converter="{StaticResource MultiConverter}">
                                    <Binding ElementName="ChangeSpacingSwitch" Path="IsOn"/>
                                    <Binding ElementName="ChangeSpacingSwitch" Path="IsEnabled"/>
                                </MultiBinding>
                            </mah:NumericUpDown.IsEnabled>

                        </mah:NumericUpDown>

                        <!--#endregion-->

                        <TextBlock Grid.Row="12" Grid.Column="3"
                               Grid.RowSpan="2"
                               TextWrapping="WrapWithOverflow"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"
                               FontWeight="Bold"
                               Margin="0 20 20 10"
                               mah:VisibilityHelper.IsHidden= "{Binding ElementName=ChangeGridColorSwitch, Path=IsEnabled}">
                            Отображение сетки отключено в <LineBreak/>основных настройках. 
                            <Hyperlink Style="{DynamicResource MahApps.Styles.Hyperlink}" Command="{Binding EnableShowGridCommand}">
                                Включить...</Hyperlink>

                        </TextBlock>

                        <!--#region blockly theme settings -->

                        <mah:ToggleSwitch Grid.Row="14" Grid.Column="0"
                                          Margin="7 0 0 0"
                                          x:Name="ChangeBlocklyTheme"
                                          Header="Тема рабочей области"
                                          OnContent="Вручную"
                                          OffContent="Автоматически"
                                          VerticalAlignment="Bottom"
                                          Command="{Binding ChangeBlocklyThemeToogleSwitchCommand}"
                                          CommandParameter="{Binding ElementName=ChangeBlocklyTheme, Path=IsOn}"
                                          IsOn="{Binding ChangeBlocklyThemeToggleSwitchState, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"/>

                        <mah:SplitButton Grid.Row="14" Grid.Column="1"
                                         IsEnabled="{Binding ElementName=ChangeBlocklyTheme, Path=IsOn}"
                                         Margin="5 20 20 5"
                                         DisplayMemberPath="BlocklyThemeName"
                                         VerticalContentAlignment="Center"
                                         HorizontalContentAlignment="Left"
                                         
                                         FontWeight="Normal"
                                         ItemsSource="{Binding BlocklyThemes}"
                                         SelectedItem="{Binding SelectedBlocklyTheme}">

                            <mah:SplitButton.Icon>
                                <StackPanel Orientation="Horizontal">
                                    <iconPacks:PackIconEvaIcons Kind="ColorPalette" Margin="5 0 5 0"/>
                                </StackPanel>
                            </mah:SplitButton.Icon>
                        </mah:SplitButton>

                        <!--#endregion-->

                        <TextBlock Grid.Row="15" Grid.Column="0"
                               Grid.ColumnSpan="3"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Left"
                               FontWeight="Bold"
                               Margin="0 20 0 10"
                               Text="Настройки области вывода результатов"/>

                        <mah:ToggleSwitch Grid.Row="16" Grid.Column="0"
                                          Margin="7 0 0 0"
                                          Header="Показывать в области выполнения"
                                          OnContent="Отчет о запуске и результат выполнения"
                                          OffContent="Только результат выполнения"
                                          VerticalAlignment="Bottom"
                                          IsOn="{Binding ChangeExtendedExecuteReportToggleSwitchState, Mode=TwoWay, Source={x:Static properties:Settings.Default}}"/>

                        <CheckBox Grid.Row="16" Grid.Column="1"
                                  Grid.ColumnSpan="2"
                                  IsChecked="True"
                                  Content="Использовать так же для редактора скриптов"
                                  IsEnabled="False"
                                  HorizontalAlignment="Center"
                                  />
                    </Grid>
                </ScrollViewer>
            </mah:Flyout>


            <!--#endregion-->

            <!--#region Flayouts notification-->

            <mah:Flyout x:Name="NotificationFlayouts"
                        Width="400"
                        Margin="0 30.4 0 30.5"
                        IsOpen="{Binding NotificationFlayoutsIsOpen, Mode=TwoWay}"
                        CloseCommand="{Binding CloseNotificationFlayots}"
                        AnimateOpacity="True"
                        Position="Right"
                        Theme="Inverse"
                        AreAnimationsEnabled="True"
                        AnimateOnPositionChange="True"
                        CloseButtonVisibility="Visible"
                        Header="Центр уведомлений"
                        Opacity="{Binding NotificationOpacity, Mode=TwoWay}"
                  
                        ContentTemplate="{Binding ElementName=FlayoutNotificationTemplate}">

                <ScrollViewer 
                              HorizontalScrollBarVisibility="Visible"
                              Style="{DynamicResource MahApps.Styles.ScrollViewer}">

                    <Grid Width="Auto" Margin="20 0 0 0"
                          x:Name="FlayoutNotificationTemplate" >
                        <Grid.RowDefinitions>
                            <RowDefinition Height="2*"/>
                            <RowDefinition Height="2*"/>
                            <RowDefinition Height="2*"/>
                            <RowDefinition Height="2*"/>
                            <RowDefinition Height="2*"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"></ColumnDefinition>
                        </Grid.ColumnDefinitions>

                        

                        <TextBlock Grid.Row="0" 
                                   VerticalAlignment="Top"
                                   HorizontalAlignment="Left"
                                   Text="Новых уведомлений нет"
                                   Visibility="{Binding NoNewNotificationMessageVisibility}"/>

                        <!--#region FailConnect Notify -->

                        <Border Grid.Row="0" 
                                Visibility="{Binding FailConnectMessageVisibility}"
                                BorderBrush="{DynamicResource MahApps.Brushes.ThemeForeground}" 
                                BorderThickness="3">

                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="1.5*"/>
                                    <RowDefinition Height="1.5*"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>


                                <TextBlock Grid.Row="0"
                                           Width="Auto" Height="Auto"
                                           Margin="10 20 0 0"
                                           FontStyle="Normal"
                                           FontWeight="Bold"
                                           FontSize="18"
                                           Text="Робот Адам отключен!" />

                                <TextBlock Grid.Row="1"
                                           Width="Auto" Height="Auto"
                                           Margin="10"
                                           FontStyle="Normal"
                                           FontWeight="Bold"
                                           FontSize="14"
                                           Text="Проверьте связь и нажмите переподключить" />

                                <Button Grid.Row="2" Width="Auto"
                                        Margin="10 5 10 10"
                                        mah:ControlsHelper.ContentCharacterCasing="Upper"
                                        Content="Переподключить" 
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        HorizontalContentAlignment="Center"
                                        VerticalContentAlignment="Center"
                                        Command="{Binding ConnectButtonComand}"
                                        CommandParameter="IsNotificationButtonCalling"
                                        Style="{StaticResource MahApps.Styles.Button.MetroSquare}"></Button>
                            </Grid>
                        </Border>
                        
                        <!--#endregion-->

                        <TextBlock Grid.Row="4"
                                   Margin="0 0 10 20"
                                   TextWrapping="WrapWithOverflow"
                                   VerticalAlignment="Bottom"
                                   HorizontalAlignment="Right"
                                   FontWeight="Bold">
                            <Hyperlink Style="{DynamicResource MahApps.Styles.Hyperlink}" Command="{Binding ClearNotifications}">
                                Очистить уведомления
                            </Hyperlink>

                        </TextBlock>

                        <!--#region  Buttons -->
                        
                        <Grid Grid.Row="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Button Grid.Column="0"
                                    Width="100"
                                    VerticalContentAlignment="Center"
                                    HorizontalContentAlignment="Center"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch"
                                    Command="{Binding ConnectButtonComand}"
                                    Background="Transparent"
                                    Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                    Style="{StaticResource MahApps.Styles.Button.MetroSquare.Accent}"
                            
                                    mah:ControlsHelper.ContentCharacterCasing="Upper"
                                    mah:ControlsHelper.CornerRadius="0">

                                <StackPanel Orientation="Vertical">
                                    <iconPacks:PackIconMaterial Margin="5 0 5 0"  
                                                                Width="Auto" 
                                                                Height="Auto"
                                                                Kind="{Binding IconOnConnectFlayoutButton}" />

                                    <Label Padding="0 5 0 0"
                                           Width="Auto" 
                                           Height="Auto" 
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Bottom"
                                           FontSize="10"
                                           FontWeight="Medium"
                                           mah:ControlsHelper.ContentCharacterCasing="Upper"
                                           Content="{Binding TextOnConnectFlayotButton}" />
                                </StackPanel>

                            </Button>
                            
                            <!--#endregion-->
                            
                        </Grid>
                    </Grid>
                </ScrollViewer>
            </mah:Flyout>
            
            <!--#endregion-->

        </mah:FlyoutsControl>

    </mah:MetroWindow.Flyouts>
    
    <!--#region Hamburger menu-->
    
    <Grid>
        <Grid.Resources>

            <uiConverter:SelectedItemToContentConverter x:Key="SelectedItemToContentConverter" />

        <!--  this is the template for the items (options too)  -->
            <DataTemplate x:Key="MenuItemTemplate" DataType="{x:Type viewModelsHamburgerMenu:HamburgerMenuItemView}">
                <Grid x:Name="RootGrid"
                      Height="48"
                      Background="Transparent">
                    
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type mah:HamburgerMenu}}, Path=CompactPaneLength}" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    
                    <ContentControl Grid.Column="0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Content="{Binding Icon}"
                                    Focusable="False" />
                    
                    <TextBlock Grid.Column="1"
                               VerticalAlignment="Center"
                               FontSize="17"
                               Text="{Binding Label}" />
                </Grid>
                
                <DataTemplate.Triggers>
                
                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type mah:HamburgerMenu}}, Path=IsPaneOpen}" Value="False">
                        <Setter TargetName="RootGrid" Property="ToolTip" Value="{Binding ToolTip, Mode=OneWay}" />
                    </DataTrigger>
                </DataTemplate.Triggers>
                
            </DataTemplate>
            
            <!--  these are the templates for the view models  -->  
            
            <DataTemplate DataType="{x:Type viewModels:ScratchControlView}">
                <viewsHamburgerItem:ScratchControl  DataContext="{Binding}" />
            </DataTemplate>
            
            <DataTemplate DataType="{x:Type viewModels:ScriptEditorControlView}">
                <viewsHamburgerItem:ScriptEditorControl DataContext="{Binding}" />
            </DataTemplate>

            <DataTemplate DataType="{x:Type viewModels:ComputerVisionControlView}">
                <viewsHamburgerItem:ComputerVisionControl DataContext="{Binding}" />
            </DataTemplate>

            <DataTemplate DataType="{x:Type viewModels:VisualSettingsControlView}">
                <viewsHamburgerItem:VisualSettingsControl DataContext="{Binding}" />
            </DataTemplate>

        </Grid.Resources>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        
        <mah:HamburgerMenu Grid.Row="0" 
                           Grid.RowSpan="2" 
                           Grid.Column="0"
                           Grid.ColumnSpan="2"
                           DisplayMode="CompactInline"
                           IsPaneOpen="False"
                           ItemTemplate="{StaticResource MenuItemTemplate}"
                           ItemsSource="{Binding MenuItems}"
                           OptionsItemTemplate="{StaticResource MenuItemTemplate}"
                           OptionsItemsSource="{Binding MenuOptionItems}"
                           SelectedIndex="{Binding SelectedPageIndex}">

            <!--  select the ViewModel of the selected item (options item)  -->
            
            <mah:HamburgerMenu.Content>
                <MultiBinding Converter="{StaticResource SelectedItemToContentConverter}">

                    <Binding FallbackValue="{x:Null}"
                             Mode="OneWay"
                             Path="SelectedItem"
                             RelativeSource="{RelativeSource Self}" />
                    <Binding FallbackValue="{x:Null}"
                             Mode="OneWay"
                             Path="SelectedOptionsItem"
                             RelativeSource="{RelativeSource Self}" />
                </MultiBinding>
            </mah:HamburgerMenu.Content>
        </mah:HamburgerMenu>

        <!--#endregion-->
        
        <!--#region  Status bar -->
        
        <StatusBar Grid.Column="0" Grid.Row="2" Grid.ColumnSpan="4"
                   Style="{StaticResource MahApps.Styles.StatusBar}">
            
            <!--#region  Item temlate -->
            
            <StatusBar.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="1.7*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="1.7*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="1*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                    </Grid>
                </ItemsPanelTemplate>
            </StatusBar.ItemsPanel>
            
            <!--#endregion-->
            
            <Separator Grid.Column="0" 
                       Margin="10 0 5 0"
                       Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}" 
                       Style="{StaticResource MahApps.Styles.Separator.StatusBar}"/>

            <!--#region Compile status bar -->

            <StatusBarItem Grid.Column="1"
                           Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}">

                <StackPanel Orientation="Horizontal">
                    <mah:ProgressRing Width="Auto" Height="Auto"
                                      Padding="5"
                                      Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                      IsActive="{Binding ProgressRingStart}" />

                    <TextBlock Margin="5 0 0 0"
                               FontWeight="Medium"
                               Text="{Binding CompileLogStatusBar }" 
                               VerticalAlignment="Center"  
                               HorizontalAlignment="Left"/>

                </StackPanel>
            </StatusBarItem>

            <!--#endregion-->

            <Separator Grid.Column="2" 
                       Margin="10 0 5 0"
                       Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}" 
                       Style="{StaticResource MahApps.Styles.Separator.StatusBar}"/>

            <!--#region AppLog status bar -->

            <StatusBarItem Grid.Column="3"
                           FontWeight="Medium"
                           Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}" 
                           Content="{Binding AppLogStatusBar}"/>

            <!--#endregion--> 

            <Separator Grid.Column="4" Margin="5 0 5 0"
                       Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}" 
                       Style="{StaticResource MahApps.Styles.Separator.StatusBar}"/>

            <!--#region Connect/Disconnect status bar-->

            <StatusBarItem Grid.Column="5" 
                           HorizontalContentAlignment="Stretch"
                           Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="0.7*"/>
                        <ColumnDefinition Width="0.35*"/>
                    </Grid.ColumnDefinitions>
                    <iconPacks:PackIconModern Margin="10 0 10 0"
                                              Grid.Column="0"
                                              VerticalAlignment="Center"
                            Kind="{Binding ConnectIcon, Mode=TwoWay}"
                                              Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"/>


                    <TextBlock Grid.Column="1"
                               VerticalAlignment="Center"
                               FontWeight="Medium"
                               Text="{Binding TextOnStatusConnectToolbar, Mode=TwoWay}" />
                </Grid>
            </StatusBarItem>

            <!--#endregion-->
   
            <Separator Grid.Column="6" 
                       Margin="5 0 5 0"
                       Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}" 
                       Style="{StaticResource MahApps.Styles.Separator.StatusBar}"/>

            <StatusBarItem  Grid.Column="7" Margin="5 0 5 0">

                <mah:Badged Padding="0 -7 1 0"
                            Margin="0 8 5 0"
                            BadgeBackground="Red"
                            BadgePlacementMode="TopRight"
                            Badge="{Binding NotificationBadge}">
                    
                    <Button Padding="3"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Command="{Binding OpenNotificationPanel}"
                            CommandParameter="{Binding ElementName=NotificationFlayouts, Path=IsOpen}"
                            Background="Transparent"
                            Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                            Style="{StaticResource MahApps.Styles.Button.ToolBar}">
                        <iconPacks:PackIconBootstrapIcons Kind="Bell" />
                    </Button>
                </mah:Badged>
            </StatusBarItem>

            <Separator Grid.Column="8" Margin="5 0 5 0"
                       Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}" 
                       Style="{StaticResource MahApps.Styles.Separator.StatusBar}"/>

        </StatusBar>
        
        <!--#endregion-->
        
    </Grid>
    
  

</mah:MetroWindow>
